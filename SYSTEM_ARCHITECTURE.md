# ๐๏ธ ุงููุนูุงุฑูุฉ ุงููุงููุฉ ููุธุงู Adora - ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช ูู **ููุทุฉ ุงูุชุญูู ุงููุฑูุฒูุฉ** ูู ุงููุธุงู. ูู ุฎูุงูู ููููู ุงูุชุญูู ูู:
- โ ุงูููุชุฌุงุช ุงูุบุฐุงุฆูุฉ ูุงููุดุฑูุจุงุช
- โ ููุชุฌุงุช ุงููููู ุจุงุฑ
- โ ุงูุฎุฏูุงุช ุงูุธุงูุฑุฉ ูููุฒูู
- โ ุงูุทูุจุงุช ูุงูุตูุงูุฉ
- โ ุงูุฑูุงุจุท ููุงุชุณุงุจ

---

## ๐ ุงูุฑุจุท ุงููุนูุงุฑู ุงููุงูู

### 1๏ธโฃ **ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช** โ **ูุงุฌูุฉ ุงููุฒูู (QR)**

**ุงููุณุงุฑ:**
```
ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช
  โ
hotel_settings/{hotelId}/menu_items
  โ
guest-engine.js โ loadMenuItems()
  โ
ููุชุฑุฉ: visibleToGuest = true && showInQR = true
  โ
ุนุฑุถ ูู QR Page
```

**ุงูููุฏ:**
```javascript
// ูู guest-engine.js
async function loadMenuItems() {
    const snapshot = await db.collection('hotel_settings')
        .doc(hotelId).collection('menu_items').get();
    return snapshot.docs.map(doc => doc.data());
}

function renderFNBTab(tab) {
    loadMenuItems().then(items => {
        // ููุชุฑุฉ ุงูููุชุฌุงุช
        const fnbItems = items.filter(item => 
            item.visibleToGuest !== false && 
            item.showInQR !== false && 
            (item.type === 'fnb' || item.type === 'orderable')
        );
        // ุนุฑุถ ุงูููุชุฌุงุช
    });
}
```

**ุงููุชูุฌุฉ:**
- ุงููุฒูู ูุฑู ููุท ุงูููุชุฌุงุช ุงูุชู `visibleToGuest = true` ู `showInQR = true`
- ุงูููุชุฌุงุช ูุฑุชุจุฉ ุญุณุจ ุงูููุน (fnb โ forms โ links)

---

### 2๏ธโฃ **ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช** โ **ูุญุต ุงููููู ุจุงุฑ**

**ุงููุณุงุฑ:**
```
ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช
  โ
hotel_settings/{hotelId}/menu_items
  โ
MinibarManager.loadMinibar()
  โ
ููุชุฑุฉ: isMiniBar = true
  โ
ุนุฑุถ ูู ูุญุต ุงููููู ุจุงุฑ
```

**ุงูููุฏ:**
```javascript
// ูู script2.js
const MinibarManager = {
    async loadMinibar() {
        const snapshot = await db.collection('hotel_settings')
            .doc(hotelId).collection('menu_items')
            .where('isMiniBar', '==', true)
            .get();
        this.items = snapshot.docs.map(doc => doc.data());
    },
    
    renderInspectionModal() {
        // ุนุฑุถ ุงูุนูุงุตุฑ ูู ูุญุต ุงููููู ุจุงุฑ
    }
};
```

**ุงููุชูุฌุฉ:**
- ุงูุนุงูู ูุฑู ููุท ุงูููุชุฌุงุช ุงูุชู `isMiniBar = true`
- ูููู ุงุฎุชูุงุฑ ุงูููุชุฌุงุช ุงููุณุชูููุฉ ูู ุงููููู ุจุงุฑ

---

### 3๏ธโฃ **ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช** โ **ุงูุทูุจุงุช ูู Adora**

**ุงููุณุงุฑ:**
```
ุงููุฒูู ูุทูุจ ููุชุฌ ูู QR
  โ
sendGuestRequest(room, category, details, mode, scheduledTime, itemId)
  โ
ุญุณุจ type:
  - type = 'form' โ guestRequests
  - type = 'fnb' โ guestRequests (requestType = 'fnb')
  - type = 'maintenance' โ activeMaintenance
  โ
ูุธูุฑ ูู Adora ูู ุงููุณู ุงูููุงุณุจ
```

**ุงูููุฏ:**
```javascript
// ูู guest-engine.js
function sendGuestRequest(room, category, details, mode, scheduledTime, itemId) {
    const payload = {
        num: roomNum,
        details: details,
        category: category,
        menuItemId: itemId, // ุฑุจุท ูุน menu_items
        fromGuest: true,
        worker: 'ูุฒูู'
    };
    
    let collectionName = 'guestRequests';
    if (category === 'maintenance') {
        collectionName = 'activeMaintenance';
    }
    
    db.collection(collectionName).add(payload);
}
```

**ุงููุชูุฌุฉ:**
- ุงูุทูุจุงุช ุชุธูุฑ ูู Adora ูุน `menuItemId` ููุฑุจุท
- ูููู ุชุชุจุน ุงูููุชุฌุงุช ุงููุทููุจุฉ ูู menu_items

---

### 4๏ธโฃ **ูููุฏ QR** โ **ูุฏูุฌ ูู ููุญุฉ ุงูุชุญูู**

**ุงููุณุงุฑ:**
```
ููุญุฉ ุชุญูู ุจูุงุจุฉ ุงููุฒูู
  โ
ุชุจููุจ QR
  โ
generateAndPrintQRFromGPM()
  โ
ุชูููุฏ QR ููู ุบุฑูุฉ
  โ
ุงูุฑุงุจุท: guest.html?room={roomNum}
```

**ุงูููุฏ:**
```javascript
// ูู script2.js
async function generateAndPrintQRFromGPM() {
    const from = parseInt(document.getElementById('gpm-qr-from').value);
    const to = parseInt(document.getElementById('gpm-qr-to').value);
    
    for (let room = from; room <= to; room++) {
        const url = `${window.location.origin}/guest.html?room=${room}`;
        // ุชูููุฏ QR Code
    }
}
```

**ุงููุชูุฌุฉ:**
- QR Codes ุชุญุชูู ุนูู ุฑุงุจุท ูุจุงุดุฑ ูุตูุญุฉ ุงููุฒูู
- ูู QR ูุฑุจูุท ุจุบุฑูุฉ ูุญุฏุฏุฉ

---

## ๐ ุจููุฉ ุงูุจูุงูุงุช (Data Structure)

### menu_items Collection
```javascript
{
  id: "item_001",
  name: "ุจูุจุณู",
  icon: "๐ฅค",
  imageUrl: "https://...",
  type: "fnb", // form | fnb | link | whatsapp | minibar | orderable
  price: "7",
  url: "", // ููุฑูุงุจุท
  whatsapp: "", // ููุงุชุณุงุจ
  visibleToGuest: true,
  isMiniBar: true,
  showInQR: true,
  instant: true,
  createdAt: 1736188800000,
  updatedAt: 1736188800000
}
```

---

## ๐ฏ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุณููุงุฑูู 1: ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ (ุจูุจุณู)
1. ุงููุฏูุฑ ููุชุญ "๐ ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช"
2. ูุถุบุท "โ ุฅุถุงูุฉ ุฎุฏูุฉ / ููุชุฌ"
3. ูููุฃ ุงูุจูุงูุงุช:
   - ุงูุงุณู: ุจูุจุณู
   - ุงูุฃููููุฉ: ๐ฅค
   - ุงูููุน: ุฃุบุฐูุฉ ููุดุฑูุจุงุช
   - ุงูุณุนุฑ: 7
   - โ ูุธูุฑ ููุถูู
   - โ ููุชูู ูููููู ุจุงุฑ
   - โ ูุธูุฑ ูู QR
   - โ ุทูุจ ููุฑู
4. ูุญูุธ โ ูุชู ุญูุธู ูู `hotel_settings/{hotelId}/menu_items`
5. **ุงููุชูุฌุฉ:**
   - โ ูุธูุฑ ูููุฒูู ูู QR
   - โ ูุธูุฑ ููุนุงูู ูู ูุญุต ุงููููู ุจุงุฑ
   - โ ุนูุฏ ุงูุทูุจ โ ููุณุฌู ูู guestRequests

### ุณููุงุฑูู 2: ุฅุถุงูุฉ ุฎุฏูุฉ ุตูุงูุฉ
1. ุงููุฏูุฑ ูุถูู ููุชุฌ ุฌุฏูุฏ:
   - ุงูุงุณู: ุจูุงุบ ุตูุงูุฉ
   - ุงูููุน: ูููุฐุฌ
   - โ ูุธูุฑ ููุถูู
   - โ ููุณ ูููู ุจุงุฑ
   - โ ูุธูุฑ ูู QR
2. **ุงููุชูุฌุฉ:**
   - โ ูุธูุฑ ูู ุชุจููุจ "ุงูุตูุงูุฉ" ูู QR
   - โ ุนูุฏ ุงูุทูุจ โ ููุณุฌู ูู activeMaintenance
   - โ ูุง ูุธูุฑ ูู ูุญุต ุงููููู ุจุงุฑ

### ุณููุงุฑูู 3: ุฅุถุงูุฉ ุฑุงุจุท ูุงุชุณุงุจ
1. ุงููุฏูุฑ ูุถูู:
   - ุงูุงุณู: ุชูุงุตู ุณุฑูุน
   - ุงูููุน: ูุงุชุณุงุจ
   - ุฑูู ูุงุชุณุงุจ: 966501234567
   - โ ูุธูุฑ ูู QR
2. **ุงููุชูุฌุฉ:**
   - โ ูุธูุฑ ูุฒุฑ ูู QR
   - โ ุนูุฏ ุงูุถุบุท โ ููุชุญ ูุงุชุณุงุจ ูุจุงุดุฑุฉ

---

## ๐ ุงูุชุฏูู ุงููุงูู (End-to-End Flow)

```
1. ุงููุฏูุฑ ูุถูู ููุชุฌ ูู ูุญุฑุฑ ุงูุฎุฏูุงุช
   โ
2. ุงูุญูุธ ูู Firebase: hotel_settings/{hotelId}/menu_items
   โ
3. Real-time Update โ guest-engine.js ููุฑุฃ ุงูุชุญุฏูุซุงุช
   โ
4. ูุงุฌูุฉ ุงููุฒูู ุชุนุฑุถ ุงูููุชุฌ (ุฅุฐุง visibleToGuest = true)
   โ
5. ุงููุฒูู ูุทูุจ ุงูููุชุฌ
   โ
6. ุงูุทูุจ ููุณุฌู ูู guestRequests ูุน menuItemId
   โ
7. ูุธูุฑ ูู Adora ูู ูุณู ุงูุทูุจุงุช
   โ
8. ุงูุนุงูู ูููู ุงูุทูุจ
   โ
9. ููุณุฌู ูู guestRequestsLog
```

---

## ๐จ ูุงุฌูุฉ ุงููุฒูู - ููู ุชุนููุ

### ุนูุฏ ูุชุญ QR:
1. `guest-engine.js` ููุฑุฃ ุงูุฅุนุฏุงุฏุงุช ูู `hotel_settings/{hotelId}`
2. ููุฑุฃ `menu_items` ูู ููุณ ุงูููุงู
3. ูููุชุฑ ุงูููุชุฌุงุช:
   ```javascript
   const visibleItems = menuItems.filter(item => 
       item.visibleToGuest !== false && 
       item.showInQR !== false
   );
   ```
4. ูุนุฑุถ ุงูููุชุฌุงุช ุญุณุจ ุงูููุน:
   - `type = 'fnb'` โ ูู ุชุจููุจ "ุงูุฃุบุฐูุฉ ูุงููุดุฑูุจุงุช"
   - `type = 'form'` โ ูู ุชุจููุจ "ุงูุทูุจุงุช" ุฃู "ุงูุตูุงูุฉ"
   - `type = 'link'` โ ูุฒุฑ ุฑุงุจุท
   - `type = 'whatsapp'` โ ูุฒุฑ ูุงุชุณุงุจ

---

## ๐ฆ ูุญุต ุงููููู ุจุงุฑ - ููู ูุนููุ

### ุนูุฏ ูุชุญ ูุญุต ุงููููู ุจุงุฑ:
1. `MinibarManager.loadMinibar()` ูุณุชุฏุนู
2. ููุฑุฃ ูู `menu_items` ุญูุซ `isMiniBar = true`
3. ูุนุฑุถ ุงูุนูุงุตุฑ ูู checkboxes
4. ุงูุนุงูู ูุฎุชุงุฑ ุงูุนูุงุตุฑ ุงููุณุชูููุฉ
5. ุนูุฏ ุงูุฅุฑุณุงู โ ููุณุฌู ูู `inspectionCards`

---

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

- โ ูุฑุงุกุฉ `menu_items` ูุชุงุญุฉ ููุฌููุน (ูููุฒูุงุก)
- โ ุงููุชุงุจุฉ ูู `menu_items` ุชุญุชุงุฌ ุตูุงุญูุงุช Admin
- โ ุงูุทูุจุงุช ูู ุงููุฒูุงุก ุชูุณุฌู ูุน `fromGuest: true`

---

## ๐ ุงูุชูุงุฑูุฑ ูุงูุชุญูููุงุช

ูููู ุฑุจุท `menuItemId` ูู ุงูุทูุจุงุช ูุน `menu_items` ูุชุญููู:
- ุฃูุซุฑ ุงูููุชุฌุงุช ุทูุจุงู
- ูุชูุณุท ุณุนุฑ ุงูุทูุจุงุช
- ุงูููุชุฌุงุช ุงูุฃูุซุฑ ุงุณุชููุงูุงู ูู ุงููููู ุจุงุฑ
- ุงูุฑุจุญูุฉ ุญุณุจ ุงูููุชุฌ

---

## โ ุงูุฎูุงุตุฉ

**ูุญุฑุฑ ูุงุฆูุฉ ุงูุฎุฏูุงุช = ููุทุฉ ุงูุชุญูู ุงููุญูุฏุฉ**

ููู ุชุชุญูู ูู:
- ๐ค ูุง ูุฑุงู ุงููุฒูู
- ๐ท ูุง ูุฑุงู ุงูุนุงูู
- ๐ฆ ูุง ูุธูุฑ ูู ุงููููู ุจุงุฑ
- ๐ฑ ูุง ูุธูุฑ ูู QR
- ๐๏ธ ุฃูู ุชูุณุฌู ุงูุทูุจุงุช
- ๐ ุงูุฑูุงุจุท ูุงูุงุชุตุงูุงุช

**ูู ุดูุก ูุฑุจูุท ููุชูุงูู! ๐**


